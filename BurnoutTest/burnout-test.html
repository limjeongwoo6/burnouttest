<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>í•˜ë£¨ ë²ˆì•„ì›ƒ ì§„ë‹¨í…ŒìŠ¤íŠ¸</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Noto Sans KR', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: linear-gradient(135deg, #2D5A3D 0%, #4A7C59 50%, #6B9B7A 100%);
            min-height: 100vh;
            color: #333;
        }

        .container {
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
        }

        .header {
            text-align: center;
            margin-bottom: 40px;
            color: white;
            padding: 40px 20px;
            background: rgba(255,255,255,0.1);
            border-radius: 20px;
            backdrop-filter: blur(10px);
        }

        .header h1 {
            font-size: 2.5rem;
            margin-bottom: 10px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
            font-weight: 800;
        }

        .header p {
            font-size: 1.1rem;
            opacity: 0.9;
            line-height: 1.6;
        }

        .progress-container {
            background: white;
            border-radius: 15px;
            padding: 30px;
            margin-bottom: 20px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
            position: relative;
            overflow: hidden;
        }

        .progress-container::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 4px;
            background: linear-gradient(90deg, #4A7C59, #6B9B7A);
        }

        .progress-bar {
            width: 100%;
            height: 8px;
            background: #e0e0e0;
            border-radius: 4px;
            overflow: hidden;
            margin-bottom: 20px;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #4A7C59, #6B9B7A);
            transition: width 0.5s ease;
            border-radius: 4px;
            position: relative;
            overflow: hidden;
        }

        .progress-fill::after {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.3), transparent);
            animation: shimmer 2s infinite;
        }

        @keyframes shimmer {
            0% { transform: translateX(-100%); }
            100% { transform: translateX(100%); }
        }

        .progress-text {
            text-align: center;
            font-weight: 600;
            color: #666;
            font-size: 1.1rem;
        }

        .question-card {
            background: white;
            border-radius: 15px;
            padding: 30px;
            margin-bottom: 20px;
            box-shadow: 0 5px 20px rgba(0,0,0,0.1);
            opacity: 0;
            transform: translateY(20px);
            transition: all 0.5s ease;
            position: relative;
            overflow: hidden;
        }

        .question-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 4px;
            background: linear-gradient(90deg, #4A7C59, #6B9B7A);
        }

        .question-card.show {
            opacity: 1;
            transform: translateY(0);
        }

        .question-number {
            display: inline-block;
            width: 35px;
            height: 35px;
            background: linear-gradient(135deg, #4A7C59, #6B9B7A);
            color: white;
            border-radius: 50%;
            text-align: center;
            line-height: 35px;
            font-weight: bold;
            margin-bottom: 15px;
            box-shadow: 0 4px 15px rgba(74, 124, 89, 0.3);
            transition: all 0.3s ease;
        }

        .question-number:hover {
            transform: scale(1.1);
        }

        .question-text {
            font-size: 1.2rem;
            margin-bottom: 20px;
            line-height: 1.6;
            color: #333;
            font-weight: 500;
        }

        .options {
            display: grid;
            gap: 10px;
        }

        .option {
            display: flex;
            align-items: center;
            padding: 15px;
            border: 2px solid #e0e0e0;
            border-radius: 10px;
            cursor: pointer;
            transition: all 0.3s ease;
            background: #fafafa;
            position: relative;
            overflow: hidden;
        }

        .option:hover {
            border-color: #6B9B7A;
            background: #f0f8f2;
            transform: translateY(-2px);
            box-shadow: 0 4px 15px rgba(74, 124, 89, 0.2);
        }

        .option.selected {
            border-color: #4A7C59;
            background: #e8f5e8;
            transform: translateY(-2px);
            box-shadow: 0 4px 15px rgba(74, 124, 89, 0.3);
        }

        .option.selected::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 3px;
            background: linear-gradient(90deg, #4A7C59, #6B9B7A);
        }

        .option input[type="radio"] {
            margin-right: 12px;
            transform: scale(1.3);
            accent-color: #4A7C59;
        }

        .option label {
            cursor: pointer;
            flex: 1;
            font-weight: 500;
            font-size: 1rem;
        }

        .button-container {
            display: flex;
            justify-content: space-between;
            margin-top: 30px;
        }

        .btn {
            padding: 12px 30px;
            border: none;
            border-radius: 25px;
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            min-width: 120px;
        }

        .btn-primary {
            background: linear-gradient(135deg, #4A7C59, #6B9B7A);
            color: white;
            position: relative;
            overflow: hidden;
        }

        .btn-primary::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.2), transparent);
            transition: left 0.5s;
        }

        .btn-primary:hover::before {
            left: 100%;
        }

        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(74, 124, 89, 0.4);
        }

        .btn-secondary {
            background: #f5f5f5;
            color: #666;
            position: relative;
            overflow: hidden;
        }

        .btn-secondary::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(0,0,0,0.1), transparent);
            transition: left 0.5s;
        }

        .btn-secondary:hover::before {
            left: 100%;
        }

        .btn-secondary:hover {
            background: #e0e0e0;
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0,0,0,0.2);
        }

        .btn:disabled {
            opacity: 0.6;
            cursor: not-allowed;
            transform: none !important;
            background: #ccc !important;
            color: #666 !important;
        }

        .btn:not(:disabled) {
            opacity: 1;
            cursor: pointer;
        }

        .btn:not(:disabled):hover {
            transform: translateY(-2px);
        }

        .btn:not(:disabled):active {
            transform: translateY(0);
        }

        .btn:not(:disabled):focus {
            outline: none;
            box-shadow: 0 0 0 3px rgba(74, 124, 89, 0.3);
        }

        .btn:not(:disabled):focus-visible {
            outline: 2px solid #4A7C59;
            outline-offset: 2px;
        }

        .btn:not(:disabled):focus-visible:active {
            outline: 2px solid #6B9B7A;
        }

        .btn:not(:disabled):focus-visible:hover {
            outline: 2px solid #4A7C59;
        }

        .btn:not(:disabled):focus-visible:focus {
            outline: 2px solid #667eea;
        }

        .btn:not(:disabled):focus-visible:focus:active {
            outline: 2px solid #764ba2;
        }

        .btn:not(:disabled):focus-visible:focus:hover {
            outline: 2px solid #667eea;
        }

        .btn:not(:disabled):focus-visible:focus:hover:active {
            outline: 2px solid #764ba2;
        }

        .btn:not(:disabled):focus-visible:focus:hover:active:focus {
            outline: 2px solid #667eea;
        }

        .btn:not(:disabled):focus-visible:focus:hover:active:focus:hover {
            outline: 2px solid #667eea;
        }

        .btn:not(:disabled):focus-visible:focus:hover:active:focus:hover:active {
            outline: 2px solid #764ba2;
        }

        .btn:not(:disabled):focus-visible:focus:hover:active:focus:hover:active:focus {
            outline: 2px solid #667eea;
        }

        .btn:not(:disabled):focus-visible:focus:hover:active:focus:hover:active:focus:hover {
            outline: 2px solid #667eea;
        }

        .btn:not(:disabled):focus-visible:focus:hover:active:focus:hover:active:focus:hover:active {
            outline: 2px solid #764ba2;
        }

        .btn:not(:disabled):focus-visible:focus:hover:active:focus:hover:active:focus:hover:active:focus {
            outline: 2px solid #667eea;
        }

        .btn:not(:disabled):focus-visible:focus:hover:active:focus:hover:active:focus:hover:active:focus:hover {
            outline: 2px solid #667eea;
        }

        .btn:not(:disabled):focus-visible:focus:hover:active:focus:hover:active:focus:hover:active:focus:hover:active {
            outline: 2px solid #764ba2;
        }

        .btn:not(:disabled):focus-visible:focus:hover:active:focus:hover:active:focus:hover:active:focus:hover:active:focus {
            outline: 2px solid #667eea;
        }

        .btn:not(:disabled):focus-visible:focus:hover:active:focus:hover:active:focus:hover:active:focus:hover:active:focus:hover {
            outline: 2px solid #667eea;
        }

        .btn:not(:disabled):focus-visible:focus:hover:active:focus:hover:active:focus:hover:active:focus:hover:active:focus:hover:active {
            outline: 2px solid #764ba2;
        }

        .btn:not(:disabled):focus-visible:focus:hover:active:focus:hover:active:focus:hover:active:focus:hover:active:focus:hover:active:focus {
            outline: 2px solid #667eea;
        }

        .btn:not(:disabled):focus-visible:focus:hover:active:focus:hover:active:focus:hover:active:focus:hover:active:focus:hover:active:focus:hover {
            outline: 2px solid #667eea;
        }

        .btn:not(:disabled):focus-visible:focus:hover:active:focus:hover:active:focus:hover:active:focus:hover:active:focus:hover:active:focus:hover:active {
            outline: 2px solid #764ba2;
        }

        .btn:not(:disabled):focus-visible:focus:hover:active:focus:hover:active:focus:hover:active:focus:hover:active:focus:hover:active:focus:hover:active:focus {
            outline: 2px solid #667eea;
        }

        .btn:not(:disabled):focus-visible:focus:hover:active:focus:hover:active:focus:hover:active:focus:hover:active:focus:hover:active:focus:hover:active:focus:hover {
            outline: 2px solid #667eea;
        }

        .btn:not(:disabled):focus-visible:focus:hover:active:focus:hover:active:focus:hover:active:focus:hover:active:focus:hover:active:focus:hover:active:focus:hover:active {
            outline: 2px solid #764ba2;
        }

        .btn:not(:disabled):focus-visible:focus:hover:active:focus:hover:active:focus:hover:active:focus:hover:active:focus:hover:active:focus:hover:active:focus:hover:active:focus {
            outline: 2px solid #667eea;
        }

        .btn:not(:disabled):focus-visible:focus:hover:active:focus:hover:active:focus:hover:active:focus:hover:active:focus:hover:active:focus:hover:active:focus:hover:active:focus:hover {
            outline: 2px solid #667eea;
        }

        .btn:not(:disabled):focus-visible:focus:hover:active:focus:hover:active:focus:hover:active:focus:hover:active:focus:hover:active:focus:hover:active:focus:hover:active:focus:hover:active {
            outline: 2px solid #764ba2;
        }

        .btn:not(:disabled):focus-visible:focus:hover:active:focus:hover:active:focus:hover:active:focus:hover:active:focus:hover:active:focus:hover:active:focus:hover:active:focus:hover:active:focus {
            outline: 2px solid #667eea;
        }

        .btn:not(:disabled):focus-visible:focus:hover:active:focus:hover:active:focus:hover:active:focus:hover:active:focus:hover:active:focus:hover:active:focus:hover:active:focus:hover:active:focus:hover {
            outline: 2px solid #667eea;
        }

        .btn:not(:disabled):focus-visible:focus:hover:active:focus:hover:active:focus:hover:active:focus:hover:active:focus:hover:active:focus:hover:active:focus:hover:active:focus:hover:active:focus:hover:active {
            outline: 2px solid #764ba2;
        }

        .btn:not(:disabled):focus-visible:focus:hover:active:focus:hover:active:focus:hover:active:focus:hover:active:focus:hover:active:focus:hover:active:focus:hover:active:focus:hover:active:focus:hover:active:focus {
            outline: 2px solid #667eea;
        }

        .btn:not(:disabled):focus-visible:focus:hover:active:focus:hover:active:focus:hover:active:focus:hover:active:focus:hover:active:focus:hover:active:focus:hover:active:focus:hover:active:focus:hover:active:focus:hover {
            outline: 2px solid #667eea;
        }

        .btn:not(:disabled):focus-visible:focus:hover:active:focus:hover:active:focus:hover:active:focus:hover:active:focus:hover:active:focus:hover:active:focus:hover:active:focus:hover:active:focus:hover:active:focus:hover:active {
            outline: 2px solid #764ba2;
        }

        .btn:not(:disabled):focus-visible:focus:hover:active:focus:hover:active:focus:hover:active:focus:hover:active:focus:hover:active:focus:hover:active:focus:hover:active:focus:hover:active:focus:hover:active:focus:hover:active:focus:hover:active:focus {
            outline: 2px solid #667eea;
        }

        .btn:not(:disabled):focus-visible:focus:hover:active:focus:hover:active:focus:hover:active:focus:hover:active:focus:hover:active:focus:hover:active:focus:hover:active:focus:hover:active:focus:hover:active:focus:hover:active:focus:hover:active:focus:hover {
            outline: 2px solid #667eea;
        }

        .btn:not(:disabled):focus-visible:focus:hover:active:focus:hover:active:focus:hover:active:focus:hover:active:focus:hover:active:focus:hover:active:focus:hover:active:focus:hover:active:focus:hover:active:focus:hover:active:focus:hover:active:focus:hover:active {
            outline: 2px solid #764ba2;
        }

        .btn:not(:disabled):focus-visible:focus:hover:active:focus:hover:active:focus:hover:active:focus:hover:active:focus:hover:active:focus:hover:active:focus:hover:active:focus:hover:active:focus:hover:active:focus:hover:active:focus:hover:active:focus:hover:active:focus {
            outline: 2px solid #667eea;
        }

        .btn:not(:disabled):focus-visible:focus:hover:active:focus:hover:active:focus:hover:active:focus:hover:active:focus:hover:active:focus:hover:active:focus:hover:active:focus:hover:active:focus:hover:active:focus:hover:active:focus:hover:active:focus:hover:active:focus:hover {
            outline: 2px solid #667eea;
        }

        .btn:not(:disabled):focus-visible:focus:hover:active:focus:hover:active:focus:hover:active:focus:hover:active:focus:hover:active:focus:hover:active:focus:hover:active:focus:hover:active:focus:hover:active:focus:hover:active:focus:hover:active:focus:hover:active:focus:hover:active {
            outline: 2px solid #764ba2;
        }

        .btn:not(:disabled):focus-visible:focus:hover:active:focus:hover:active:focus:hover:active:focus:hover:active:focus:hover:active:focus:hover:active:focus:hover:active:focus:hover:active:focus:hover:active:focus:hover:active:focus:hover:active:focus:hover:active:focus:hover:active:focus:hover:active:focus {
            outline: 2px solid #667eea;
        }

        .btn:not(:disabled):focus-visible:focus:hover:active:focus:hover:active:focus:hover:active:focus:hover:active:focus:hover:active:focus:hover:active:focus:hover:active:focus:hover:active:focus:hover:active:focus:hover:active:focus:hover:active:focus:hover:active:focus:hover:active:focus:hover:active:focus:hover {
            outline: 2px solid #667eea;
        }

        .results-container {
            background: white;
            border-radius: 20px;
            padding: 40px;
            margin-top: 20px;
            box-shadow: 0 15px 35px rgba(15, 81, 50, 0.08);
            opacity: 0;
            transform: translateY(20px);
            transition: all 0.5s ease;
            position: relative;
            overflow: hidden;
            border: 1px solid rgba(25, 135, 84, 0.1);
        }

        .results-container::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 4px;
            background: linear-gradient(90deg, #4A7C59, #6B9B7A);
        }

        .results-container.show {
            opacity: 1;
            transform: translateY(0);
        }

        .result-card {
            background: #f8f9fa;
            border-radius: 15px;
            padding: 25px;
            margin-bottom: 25px;
            border-left: 5px solid #4A7C59;
            transition: all 0.3s ease;
            border: 1px solid rgba(74, 124, 89, 0.1);
        }

        .result-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 20px rgba(0,0,0,0.1);
        }

        .result-title {
            font-size: 1.5rem;
            font-weight: 700;
            margin-bottom: 15px;
            color: #2C3E50;
            border-bottom: 3px solid #4A7C59;
            padding-bottom: 10px;
        }

        .result-content {
            color: #34495E;
            line-height: 1.7;
            font-size: 1.1rem;
        }

        .type-distribution {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin: 20px 0;
        }

        .type-item {
            background: white;
            padding: 15px;
            border-radius: 10px;
            text-align: center;
            border: 2px solid #e0e0e0;
            transition: all 0.3s ease;
        }

        .type-item:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
        }

        .type-item.primary {
            border-color: #4A7C59;
            background: #f0f8f2;
            transform: scale(1.05);
            box-shadow: 0 5px 20px rgba(74, 124, 89, 0.3);
        }

        .type-name {
            font-weight: bold;
            margin-bottom: 5px;
            font-size: 1.1rem;
        }

        .type-percentage {
            font-size: 1.5rem;
            font-weight: bold;
            color: #4A7C59;
            text-shadow: 1px 1px 2px rgba(0,0,0,0.1);
        }

        .stage-indicator {
            display: flex;
            justify-content: center;
            margin-bottom: 30px;
        }

        .stage-pill {
            padding: 8px 20px;
            margin: 0 10px;
            border-radius: 20px;
            background: rgba(255,255,255,0.2);
            color: white;
            font-weight: 500;
            transition: all 0.3s ease;
            font-size: 1rem;
        }

        .stage-pill.active {
            background: white;
            color: #4A7C59;
            transform: scale(1.05);
            box-shadow: 0 4px 15px rgba(255,255,255,0.3);
            font-weight: 600;
        }

        .stage-separator {
            text-align: center;
            padding: 40px;
            background: linear-gradient(135deg, #F0F8F2 0%, #E8F5E8 100%);
            border-radius: 20px;
            margin: 30px 0;
            border: 1px solid rgba(74, 124, 89, 0.1);
        }

        .stage-separator h2 {
            color: #4A7C59;
            font-size: 2rem;
            margin-bottom: 15px;
            font-weight: 700;
        }

        .stage-separator p {
            color: #495057;
            font-size: 1.1rem;
            margin-bottom: 25px;
            line-height: 1.6;
        }

        .continue-btn {
            background: linear-gradient(135deg, #4A7C59 0%, #6B9B7A 100%);
            color: white;
            padding: 18px 40px;
            border: none;
            border-radius: 15px;
            font-size: 1.2rem;
            font-weight: 700;
            cursor: pointer;
            transition: all 0.4s ease;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            box-shadow: 0 8px 25px rgba(74, 124, 89, 0.3);
        }

        .continue-btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 12px 35px rgba(74, 124, 89, 0.4);
            background: linear-gradient(135deg, #3A6B49 0%, #5A8B69 100%);
        }

        .consultation-card {
            background: linear-gradient(135deg, #F8F9FA 0%, #E9ECEF 100%);
            border-radius: 20px;
            padding: 30px;
            margin: 25px 0;
            border: 2px solid #4A7C59;
            text-align: center;
            position: relative;
            overflow: hidden;
        }

        .consultation-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 4px;
            background: linear-gradient(90deg, #4A7C59, #6B9B7A);
        }

        .consultation-card h3 {
            color: #4A7C59;
            font-size: 1.5rem;
            margin-bottom: 15px;
            font-weight: 700;
        }

        .consultation-card p {
            color: #495057;
            font-size: 1rem;
            line-height: 1.6;
            margin-bottom: 20px;
        }

        .consultation-btn {
            background: linear-gradient(135deg, #4A7C59 0%, #6B9B7A 100%);
            color: white;
            padding: 15px 30px;
            border: none;
            border-radius: 12px;
            font-size: 1.1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            text-decoration: none;
            display: inline-block;
            box-shadow: 0 6px 20px rgba(74, 124, 89, 0.3);
        }

        .consultation-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(74, 124, 89, 0.4);
            background: linear-gradient(135deg, #3A6B49 0%, #5A8B69 100%);
            text-decoration: none;
            color: white;
        }

        @media (max-width: 768px) {
            .container {
                padding: 10px;
            }
            
            .header h1 {
                font-size: 2rem;
            }
            
            .question-card {
                padding: 20px;
            }
            
            .button-container {
                flex-direction: column;
                gap: 10px;
            }
            
            .btn {
                width: 100%;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>í•˜ë£¨ ë²ˆì•„ì›ƒ ì§„ë‹¨í…ŒìŠ¤íŠ¸</h1>
            <p>1ì°¨ ì§„ë‹¨ìœ¼ë¡œ ë²ˆì•„ì›ƒ ìœ„í—˜ë„ë¥¼ í™•ì¸í•˜ê³ , ì´ì–´ì„œ 2ì°¨ ì§„ë‹¨ìœ¼ë¡œ ìœ í˜• ë¶„í¬ë¥¼ í™•ì¸í•˜ì„¸ìš”.</p>
        </div>

        <div class="stage-indicator">
            <div class="stage-pill active" id="stage1-indicator">1ì°¨ ì§„ë‹¨</div>
            <div class="stage-pill" id="stage2-indicator">2ì°¨ ì§„ë‹¨</div>
            <div class="stage-pill" id="stage3-indicator">ì¢…í•© ê²°ê³¼</div>
        </div>

        <div class="progress-container">
            <div class="progress-bar">
                <div class="progress-fill" id="progress-fill"></div>
            </div>
            <div class="progress-text" id="progress-text">ì§„í–‰ë„: 0/22 (0%)</div>
        </div>

        <div id="question-container"></div>

        <div class="button-container" id="button-container">
            <button class="btn btn-secondary" id="reset-btn" onclick="resetTest()">ì´ˆê¸°í™”</button>
            <button class="btn btn-primary" id="next-btn" onclick="nextQuestion()" disabled>ë‹¤ìŒ</button>
        </div>

        <div class="results-container" id="results-container">
            <div id="results-content"></div>
        </div>
    </div>

    <script>
        // 1ì°¨ ì§„ë‹¨ ë¬¸í•­ (12ë¬¸í•­)
        const stage1Questions = [
            { id: "S1_Q1", text: "ì•„ì¹¨ì— ì¼ì–´ë‚˜ë©´ ì¶œê·¼(ë“±êµ)í•˜ê³  ì‹¶ì§€ ì•Šë‹¤." },
            { id: "S1_Q2", text: "í•˜ë£¨ê°€ ëë‚˜ë©´ ì™„ì „íˆ ì§€ì³ì„œ ì•„ë¬´ê²ƒë„ í•  ìˆ˜ ì—†ë‹¤." },
            { id: "S1_Q3", text: "ì—…ë¬´Â·ê³µë¶€ ì„±ê³¼ê°€ ëˆˆì— ë„ê²Œ ë–¨ì–´ì§„ ê²ƒ ê°™ë‹¤." },
            { id: "S1_Q4", text: "ë™ë£ŒÂ·ê³ ê°Â·ì£¼ë³€ ì‚¬ëŒê³¼ì˜ ëŒ€í™”ê°€ í”¼ê³¤í•˜ê³  ê·€ì°®ë‹¤." },
            { id: "S1_Q5", text: "ì‰¬ëŠ” ì‹œê°„ì—ë„ ê³„ì† ì—…ë¬´Â·ê³µë¶€ ìƒê°ì„ í•œë‹¤." },
            { id: "S1_Q6", text: "ìŠ¤ìŠ¤ë¡œ ë¬´ëŠ¥ë ¥í•˜ë‹¤ê³  ëŠë‚€ë‹¤." },
            { id: "S1_Q7", text: "ì¶œê·¼ê¸¸(ë“±êµ£ê¸¸)ì— ëª¸ì´ ë¬´ê²ê³  í”¼ê³¤í•˜ë‹¤." },
            { id: "S1_Q8", text: "ì£¼ë§ì´ ì§€ë‚˜ë„ í”¼ë¡œê°€ í’€ë¦¬ì§€ ì•ŠëŠ”ë‹¤." },
            { id: "S1_Q9", text: "ìµœê·¼ ì¼ì˜ ì˜ë¯¸ê°€ ì ì  ì‚¬ë¼ì§„ ê²ƒ ê°™ë‹¤." },
            { id: "S1_Q10", text: "ë…¸ë ¥í•´ë„ ì¸ì •ë°›ì§€ ëª»í•œë‹¤ê³  ëŠë‚€ë‹¤." },
            { id: "S1_Q11", text: "'ë” í•´ì•¼ í•œë‹¤'ëŠ” ì••ë°•ê° ë•Œë¬¸ì— ë¶ˆì•ˆí•˜ë‹¤." },
            { id: "S1_Q12", text: "ì¼ì˜ ë¯¸ë˜ê°€ ë³´ì´ì§€ ì•Šì•„ íšŒì˜ê°ì´ ë“ ë‹¤." }
        ];

        // 2ì°¨ ì§„ë‹¨ ë¬¸í•­ (10ë¬¸í•­)
        const stage2Questions = [
            {
                id: "T2_Q1",
                text: "ì—…ë¬´ê°€ ëª°ë¦´ ë•Œ, ë‚˜ì˜ ê¸°ë³¸ ë°˜ì‘ì€?",
                choices: [
                    { key: "O", label: "ë” ëª°ì•„ë¶™ì—¬ì„œë¼ë„ ëë‚¸ë‹¤ (ì‰¬ë©´ ë¶ˆì•ˆ)" },
                    { key: "N", label: "í•´ë„ ë‹¬ë¼ì§ˆ ê²Œ ì—†ë‹¤ê³  ëŠê»´ ì†ì´ ì•ˆ ê°„ë‹¤" },
                    { key: "F", label: "ì´ê²Œ ë¬´ìŠ¨ ì˜ë¯¸ê°€ ìˆë‚˜ íšŒì˜ê°ì´ ë“ ë‹¤" },
                    { key: "ON", label: "í•´ì•¼ í•˜ì§€ë§Œ ì¸ì • ëª» ë°›ì„ ê²ƒ ê°™ì•„ ì§€ì¹œë‹¤" },
                    { key: "NF", label: "ì˜ë¯¸ë„ ì—†ê³  ì¸ì •ë„ ëª» ë°›ëŠ” ê¸°ë¶„ì´ë‹¤" }
                ]
            },
            {
                id: "T2_Q2",
                text: "ì£¼ë§ì˜ ë‚˜ë¥¼ ê°€ì¥ ì˜ ì„¤ëª…í•˜ëŠ” ë§ì€?",
                choices: [
                    { key: "O", label: "ì‰¬ë©´ ë’¤ì²˜ì§ˆê¹Œ ë¶ˆì•ˆí•´ì„œ ì¼ ê´€ë ¨ ì •ë¦¬í•œë‹¤" },
                    { key: "N", label: "ì¶©ì „í•´ë„ ì›”ìš”ì¼ì´ë©´ ë‹¤ì‹œ ë°©ì „ë  ê²ƒ ê°™ë‹¤" },
                    { key: "F", label: "ë¬´ì—‡ì„ í•´ë„ ì˜ë¯¸ê°€ ì˜ ëŠê»´ì§€ì§€ ì•ŠëŠ”ë‹¤" },
                    { key: "ON", label: "í•´ì•¼ í•  ê±´ ë§ì§€ë§Œ ë™ë ¥ì€ ì˜ ì•ˆ ë¶™ëŠ”ë‹¤" },
                    { key: "NF", label: "ì¼ë„ ì‹«ê³ , í•œë‹¤ê³  ë‹¬ë¼ì§ˆ ê²ƒë„ ì—†ë‹¤" }
                ]
            },
            {
                id: "T2_Q3",
                text: "ì„±ê³¼ í”¼ë“œë°±ì„ ë°›ì•˜ì„ ë•Œ ë“œëŠ” ìƒê°ì€?",
                choices: [
                    { key: "O", label: "ë” ì˜í•˜ë ¤ë©´ ì‰¬ë©´ ì•ˆ ëœë‹¤" },
                    { key: "N", label: "ì—´ì‹¬íˆ í•´ë„ ì¸ì • ëª» ë°›ëŠ”êµ¬ë‚˜" },
                    { key: "F", label: "ë‚´ê°€ ì§„ì§œ ì›í•˜ëŠ” ê¸¸ì´ ë§ë‚˜?" },
                    { key: "ON", label: "í•´ì•¼ í•˜ì§€ë§Œ ì–´ì°¨í”¼ ì¸ì •ì€ ëª» ë°›ì„ ë“¯" },
                    { key: "NF", label: "ì¸ì •ë„ ì˜ë¯¸ë„ ì—†ë‹¤ëŠ” ìƒê°ì´ ë“ ë‹¤" }
                ]
            },
            {
                id: "T2_Q4",
                text: "ë™ë£Œê°€ í‡´ê·¼ í›„ ì‰¬ë¼ê³  í•  ë•Œ ë‚˜ì˜ ë°˜ì‘ì€?",
                choices: [
                    { key: "O", label: "ë¶ˆì•ˆí•´ì„œ ì¡°ê¸ˆ ë” ì¼í•œë‹¤" },
                    { key: "N", label: "ì‰¬ì–´ë„ ë‚´ì¼ ë³€í™” ì—†ì„ ê²ƒ ê°™ì•„ ë¬´ë¤ë¤" },
                    { key: "F", label: "ì‰¬ì–´ë„ ë°©í–¥ì´ ì—†ìœ¼ë‹ˆ ê³µí—ˆí•˜ë‹¤" },
                    { key: "ON", label: "ì‰¬ê³  ì‹¶ì§€ë§Œ ì„±ê³¼ ì••ë°•ê³¼ ì¸ì • ê°ˆì¦ì´ ì„ì¸ë‹¤" },
                    { key: "NF", label: "ì‰¬ì–´ë„ ì˜ë¯¸ ì—†ê³  ì¸ì •ë„ ì—†ë‹¤" }
                ]
            },
            {
                id: "T2_Q5",
                text: "í”„ë¡œì íŠ¸ ì´ˆê¸° ë‹¨ê³„ì—ì„œ ê°€ì¥ í° ê³ ë¯¼ì€?",
                choices: [
                    { key: "O", label: "ì™„ë²½í•˜ê²Œ í•´ë‚¼ ìˆ˜ ìˆì„ì§€ ë¶ˆì•ˆí•˜ë‹¤" },
                    { key: "N", label: "ë‚´ê°€ í•´ë„ ê²°ê³¼ëŠ” ë˜‘ê°™ì„ ê²ƒ ê°™ë‹¤" },
                    { key: "F", label: "ì´ê²Œ ë‚´ ì»¤ë¦¬ì–´/ê°€ì¹˜ì™€ ë§ëŠ”ê°€?" },
                    { key: "ON", label: "ì„±ê³¼ë„ ì¤‘ìš”í•˜ì§€ë§Œ ì¸ì •ë°›ì„ ìˆ˜ ìˆì„ê¹Œ?" },
                    { key: "NF", label: "ì• ì¨ë„ ì˜ë¯¸ë„ ì¸ì •ë„ ëª» ì–»ì„ ë“¯í•˜ë‹¤" }
                ]
            },
            {
                id: "T2_Q6",
                text: "ì—…ë¬´ ì¤‘ ì§‘ì¤‘ì´ ê¹¨ì§ˆ ë•Œ ê°€ì¥ ê°€ê¹Œìš´ ì´ìœ ëŠ”?",
                choices: [
                    { key: "O", label: "ë” í•´ì•¼ í•œë‹¤ëŠ” ì••ë°•ìœ¼ë¡œ ê³¼ëª°ì…/ë¶ˆì•ˆ" },
                    { key: "N", label: "ë¬´ê¸°ë ¥ê³¼ ì²´ë…ìœ¼ë¡œ ì†ì´ ë©ˆì¶˜ë‹¤" },
                    { key: "F", label: "ì˜ë¯¸ ìƒì‹¤ë¡œ ì§‘ì¤‘ì´ ì–´ë ¤ì›€" },
                    { key: "ON", label: "í•´ì•¼ í•˜ì§€ë§Œ ì¸ì •ë°›ì§€ ëª»í•  ë“¯í•´ ë™ë ¥ì´ ì•½í•¨" },
                    { key: "NF", label: "ì˜ë¯¸ë„ ì¸ì •ë„ ì—†ì–´ ì§‘ì¤‘ì´ í’€ë¦°ë‹¤" }
                ]
            },
            {
                id: "T2_Q7",
                text: "ì•¼ê·¼ì´ ì¦ì•„ì§ˆ ë•Œ ë§ˆìŒ ìƒíƒœëŠ”?",
                choices: [
                    { key: "O", label: "ê·¸ë˜ë„ ì„±ê³¼ ë‚´ë ¤ë©´ ë²„í…¨ì•¼ í•œë‹¤" },
                    { key: "N", label: "ë²„í…¨ë„ ë‹¬ë¼ì§ˆ ê²Œ ì—†ë‹¤" },
                    { key: "F", label: "ë‚´ê°€ ì›í•˜ëŠ” ì‚¶ê³¼ ë©€ì–´ì§€ëŠ” ëŠë‚Œ" },
                    { key: "ON", label: "ë²„í…¨ì•¼ í•˜ì§€ë§Œ ì¸ì •ë„ ëª» ë°›ì„ ê²ƒ ê°™ë‹¤" },
                    { key: "NF", label: "ë²„í…¨ë„ ì˜ë¯¸Â·ì¸ì • ëª¨ë‘ ì—†ë‹¤" }
                ]
            },
            {
                id: "T2_Q8",
                text: "ì„±ê³¼ë¥¼ ë‚¸ í›„ í•˜ë£¨, ë‚˜ëŠ” ë³´í†µâ€¦",
                choices: [
                    { key: "O", label: "ë” ë‹¬ë ¤ì•¼ í•œë‹¤ê³  ëŠë‚€ë‹¤ (ì‰¬ë©´ ë¶ˆì•ˆ)" },
                    { key: "N", label: "ë‹¤ìŒì—” ìš´ì´ ì—†ìœ¼ë©´ ëª» í•  ë“¯í•˜ë‹¤" },
                    { key: "F", label: "ì™œ ì´ë ‡ê²Œê¹Œì§€ í•´ì•¼ í–ˆì§€? ì˜ë¯¸ê°€ ì˜ë¬¸" },
                    { key: "ON", label: "ë˜ í•´ë‚´ì•¼ í•˜ëŠ”ë° ì¸ì • ë°›ì„ì§„ ëª¨ë¥´ê² ë‹¤" },
                    { key: "NF", label: "ì„±ê³¼ë„ ê²°êµ­ ë³„ ì˜ë¯¸Â·ì¸ì •ì´ ì—†ë‹¤" }
                ]
            },
            {
                id: "T2_Q9",
                text: "ìƒˆ ëª©í‘œë¥¼ ì„¸ìš¸ ë•Œ ê°€ì¥ ë¨¼ì € ë– ì˜¤ë¥´ëŠ” ìƒê°ì€?",
                choices: [
                    { key: "O", label: "ì™„ë²½í•œ ê³„íšê³¼ ëª°ì…ìœ¼ë¡œ ë°€ì–´ë¶™ì´ì" },
                    { key: "N", label: "í•´ë„ í° ë³€í™”ëŠ” ì—†ì„ ê²ƒ ê°™ë‹¤" },
                    { key: "F", label: "ì´ ëª©í‘œê°€ ë‚´ ê°€ì¹˜ì™€ ë§ëŠ”ê°€?" },
                    { key: "ON", label: "ì„±ê³¼ë„ ì¤‘ìš”í•˜ê³  ì¸ì •ë„ ë°›ì•„ì•¼ í•œë‹¤" },
                    { key: "NF", label: "ì˜ë¯¸ë„ í¬ë¯¸í•˜ê³  ì¸ì •ë„ ê¸°ëŒ€ ì•ˆ í•œë‹¤" }
                ]
            },
            {
                id: "T2_Q10",
                text: "íŒ€/ìƒì‚¬ì™€ ê°ˆë“± ì‹œ ë“œëŠ” ìƒê°ì€?",
                choices: [
                    { key: "O", label: "ë‚´ê°€ ë” ì˜í•´ì•¼ í•œë‹¤ëŠ” ë¶€ë‹´ì´ ì»¤ì§„ë‹¤" },
                    { key: "N", label: "ì–´ì°¨í”¼ ë°”ë€Œì§€ ì•ŠëŠ”ë‹¤ (ì²´ë…)" },
                    { key: "F", label: "ì—¬ê¸°ì„œ ë‚´ ì„±ì¥ì´ ê°€ëŠ¥í•œê°€?" },
                    { key: "ON", label: "ì„±ê³¼Â·ì¸ì • ëª¨ë‘ ë¶ˆì•ˆì •í•´ ë” ì§€ì¹œë‹¤" },
                    { key: "NF", label: "ì˜ë¯¸ ì—†ê³  ì¸ì •ë„ ëª» ë°›ì„ ê°ˆë“± ê°™ë‹¤" }
                ]
            }
        ];

        // 1ì°¨ ì§„ë‹¨ ë“±ê¸‰ ê¸°ì¤€
        const stage1Bands = [
            { label: "ë²ˆì•„ì›ƒ ìœ„í—˜ ë‚®ìŒ", min: 12, max: 24, color: "#16a34a" },
            { label: "ê²½ë„ ë²ˆì•„ì›ƒ ê°€ëŠ¥ì„±", min: 25, max: 40, color: "#f59e0b" },
            { label: "ë²ˆì•„ì›ƒ ìœ„í—˜ (ìƒë‹´ í•„ìš”)", min: 41, max: 60, color: "#dc2626" }
        ];

        // 2ì°¨ ì§„ë‹¨ ê°€ì¤‘ì¹˜
        const stage2Weights = {
            O: { overload: 1 },
            N: { neglect: 1 },
            F: { frustration: 1 },
            ON: { overload: 0.5, neglect: 0.5 },
            NF: { neglect: 0.5, frustration: 0.5 }
        };

        const typeLabels = {
            overload: "ê³¼ë¶€í•˜í˜•",
            neglect: "ë°©ì¹˜í˜•",
            frustration: "ì¢Œì ˆí˜•"
        };

        const typeDescriptions = {
            overload: "ëŠì„ì—†ì´ ë” ë§ì´, ë” ì™„ë²½í•˜ê²Œ í•´ì•¼ í•œë‹¤ëŠ” ì••ë°•ì´ í½ë‹ˆë‹¤. 'ì‰¬ë©´ ë’¤ì²˜ì§„ë‹¤'ëŠ” ë¶ˆì•ˆìœ¼ë¡œ ê³¼ë¡œÂ·ìê¸°í¬ìƒì´ ë°˜ë³µë©ë‹ˆë‹¤.",
            neglect: "ë…¸ë ¥ ëŒ€ë¹„ ì¸ì •Â·ë³´ìƒì´ ë¶€ì¡±í•˜ë‹¤ê³  ëŠë¼ë©° ë¬´ê¸°ë ¥ê³¼ ëƒ‰ì†Œê°€ ìŒ“ì…ë‹ˆë‹¤. íš¨ëŠ¥ê° ì €í•˜ì™€ íšŒí”¼ê°€ ë‚˜íƒ€ë‚˜ê¸° ì‰½ìŠµë‹ˆë‹¤.",
            frustration: "ê¸°ëŒ€ì™€ í˜„ì‹¤ì˜ ê´´ë¦¬ê°€ í¬ê³ , ì¼ì˜ ì˜ë¯¸Â·ëª©í‘œê°€ íë ¤ì§‘ë‹ˆë‹¤. ë™ê¸° ìƒì‹¤ê³¼ ë°©í–¥ì„± í˜¼ë€ì´ í•µì‹¬ì…ë‹ˆë‹¤."
        };

        // ì „ì—­ ë³€ìˆ˜
        let currentStage = 1;
        let currentQuestionIndex = 0;
        let stage1Answers = {};
        let stage2Answers = {};
        let totalQuestions = stage1Questions.length + stage2Questions.length;

        // í˜ì´ì§€ ë¡œë“œ ì‹œ ì´ˆê¸°í™”
        document.addEventListener('DOMContentLoaded', function() {
            // ì´ˆê¸° ìƒíƒœ ì„¤ì •
            currentStage = 1;
            currentQuestionIndex = 0;
            stage1Answers = {};
            stage2Answers = {};
            
            // UI ì´ˆê¸°í™”
            document.querySelectorAll('.stage-pill').forEach(pill => pill.classList.remove('active'));
            const stage1Indicator = document.getElementById('stage1-indicator');
            if (stage1Indicator) {
                stage1Indicator.classList.add('active');
            }
            
            // ì§„í–‰ë¥  ì´ˆê¸°í™”
            const progressFill = document.getElementById('progress-fill');
            const progressText = document.getElementById('progress-text');
            if (progressFill) progressFill.style.width = '0%';
            if (progressText) progressText.textContent = 'ì§„í–‰ë„: 0/22 (0%)';
            
            // ë‹¤ìŒ ë²„íŠ¼ ì´ˆê¸°í™”
            const nextBtn = document.getElementById('next-btn');
            if (nextBtn) {
                nextBtn.disabled = true;
                nextBtn.textContent = 'ì„ íƒí•´ì£¼ì„¸ìš”';
            }
            
            // ì²« ë²ˆì§¸ ì§ˆë¬¸ í‘œì‹œ
            showQuestion();
            updateProgress();
        });

        function showQuestion() {
            const container = document.getElementById('question-container');
            if (!container) return;
            
            const isStage1 = currentStage === 1;
            const questions = isStage1 ? stage1Questions : stage2Questions;
            const question = questions[currentQuestionIndex];
            
            if (!question) {
                showResults();
                return;
            }

            let html = `
                <div class="question-card show">
                    <div class="question-number">${currentQuestionIndex + 1}</div>
                    <div class="question-text">${question.text}</div>
                    <div class="options">
            `;

            if (isStage1) {
                // 1ì°¨ ì§„ë‹¨: 5ì  ë¦¬ì»¤íŠ¸ ì²™ë„
                const likertOptions = [
                    { value: 1, label: "1 ì „í˜€ ì•„ë‹ˆë‹¤" },
                    { value: 2, label: "2 ê±°ì˜ ì•„ë‹ˆë‹¤" },
                    { value: 3, label: "3 ë³´í†µì´ë‹¤" },
                    { value: 4, label: "4 ê·¸ë ‡ë‹¤" },
                    { value: 5, label: "5 ë§¤ìš° ê·¸ë ‡ë‹¤" }
                ];

                likertOptions.forEach(option => {
                    const isSelected = stage1Answers[question.id] === option.value;
                    html += `
                        <div class="option ${isSelected ? 'selected' : ''}" onclick="selectStage1Option('${question.id}', ${option.value})">
                            <input type="radio" name="${question.id}" value="${option.value}" ${isSelected ? 'checked' : ''}>
                            <label>${option.label}</label>
                        </div>
                    `;
                });
            } else {
                // 2ì°¨ ì§„ë‹¨: ì„ íƒí˜• ë¬¸í•­
                question.choices.forEach(choice => {
                    const isSelected = stage2Answers[question.id] === choice.key;
                    html += `
                        <div class="option ${isSelected ? 'selected' : ''}" onclick="selectStage2Option('${question.id}', '${choice.key}')">
                            <input type="radio" name="${question.id}" value="${choice.key}" ${isSelected ? 'checked' : ''}>
                            <label>${choice.label}</label>
                        </div>
                    `;
                });
            }

            html += `
                    </div>
                </div>
            `;

            container.innerHTML = html;
            
            // ì„ íƒëœ ì˜µì…˜ì´ ìˆë‹¤ë©´ ì‹œê°ì ìœ¼ë¡œ í‘œì‹œ
            if (isStage1 && stage1Answers[question.id]) {
                const selectedValue = stage1Answers[question.id];
                const selectedRadio = document.querySelector(`input[name="${question.id}"][value="${selectedValue}"]`);
                if (selectedRadio) {
                    selectedRadio.checked = true;
                    selectedRadio.closest('.option').classList.add('selected');
                }
            } else if (!isStage1 && stage2Answers[question.id]) {
                const selectedValue = stage2Answers[question.id];
                const selectedRadio = document.querySelector(`input[name="${question.id}"][value="${selectedValue}"]`);
                if (selectedRadio) {
                    selectedRadio.checked = true;
                    selectedRadio.closest('.option').classList.add('selected');
                }
            }
            
            updateProgress();
            updateNextButton();
        }

        function selectStage1Option(questionId, value) {
            stage1Answers[questionId] = value;
            
            // í˜„ì¬ ì§ˆë¬¸ì˜ ëª¨ë“  ì˜µì…˜ì—ì„œ ì„ íƒ í•´ì œ
            const currentOptions = document.querySelectorAll(`input[name="${questionId}"]`);
            currentOptions.forEach(radio => {
                radio.checked = false;
                radio.closest('.option').classList.remove('selected');
            });
            
            // ì„ íƒëœ ì˜µì…˜ë§Œ ì²´í¬
            const selectedRadio = document.querySelector(`input[name="${questionId}"][value="${value}"]`);
            if (selectedRadio) {
                selectedRadio.checked = true;
                selectedRadio.closest('.option').classList.add('selected');
            }
            
            updateNextButton();
            updateProgress();
        }

        function selectStage2Option(questionId, value) {
            stage2Answers[questionId] = value;
            
            // í˜„ì¬ ì§ˆë¬¸ì˜ ëª¨ë“  ì˜µì…˜ì—ì„œ ì„ íƒ í•´ì œ
            const currentOptions = document.querySelectorAll(`input[name="${questionId}"]`);
            currentOptions.forEach(radio => {
                radio.checked = false;
                radio.closest('.option').classList.remove('selected');
            });
            
            // ì„ íƒëœ ì˜µì…˜ë§Œ ì²´í¬
            const selectedRadio = document.querySelector(`input[name="${questionId}"][value="${value}"]`);
            if (selectedRadio) {
                selectedRadio.checked = true;
                selectedRadio.closest('.option').classList.add('selected');
            }
            
            updateNextButton();
            updateProgress();
        }

        function updateNextButton() {
            const nextBtn = document.getElementById('next-btn');
            if (!nextBtn) return;
            
            const isStage1 = currentStage === 1;
            const questions = isStage1 ? stage1Questions : stage2Questions;
            const answers = isStage1 ? stage1Answers : stage2Answers;
            const question = questions[currentQuestionIndex];
            
            if (!question) {
                nextBtn.disabled = true;
                nextBtn.textContent = 'ì„ íƒí•´ì£¼ì„¸ìš”';
                return;
            }
            
            const hasAnswer = answers[question.id] !== undefined;
            
            if (hasAnswer) {
                nextBtn.disabled = false;
                if (currentQuestionIndex === questions.length - 1) {
                    nextBtn.textContent = isStage1 ? '1ì°¨ ê²°ê³¼ ë³´ê¸° & 2ì°¨ë¡œ ì§„í–‰' : 'ì¢…í•© ê²°ê³¼ ë³´ê¸°';
                } else {
                    nextBtn.textContent = 'ë‹¤ìŒ';
                }
            } else {
                nextBtn.disabled = true;
                nextBtn.textContent = 'ì„ íƒí•´ì£¼ì„¸ìš”';
            }
        }

        function nextQuestion() {
            const isStage1 = currentStage === 1;
            const questions = isStage1 ? stage1Questions : stage2Questions;
            const answers = isStage1 ? stage1Answers : stage2Answers;
            const question = questions[currentQuestionIndex];
            
            if (!question) {
                alert('ì§ˆë¬¸ì„ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.');
                return;
            }
            
            // í˜„ì¬ ì§ˆë¬¸ì— ë‹µë³€ì´ ìˆëŠ”ì§€ í™•ì¸
            if (!answers[question.id]) {
                alert('ë‹µë³€ì„ ì„ íƒí•´ì£¼ì„¸ìš”.');
                return;
            }
            
            if (currentQuestionIndex < questions.length - 1) {
                currentQuestionIndex++;
                showQuestion();
            } else {
                // í˜„ì¬ ë‹¨ê³„ ì™„ë£Œ
                if (currentStage === 1) {
                    // 1ì°¨ ì§„ë‹¨ ì™„ë£Œ, 1ì°¨ ê²°ê³¼ í‘œì‹œ
                    showStage1Results();
                } else {
                    // 2ì°¨ ì§„ë‹¨ ì™„ë£Œ, ì¢…í•© ê²°ê³¼ í‘œì‹œ
                    showFinalResults();
                }
            }
        }

        function updateStageIndicator() {
            const stagePills = document.querySelectorAll('.stage-pill');
            stagePills.forEach(pill => pill.classList.remove('active'));
            
            const activeStage = document.getElementById(`stage${currentStage}-indicator`);
            if (activeStage) {
                activeStage.classList.add('active');
            }
        }

        function updateProgress() {
            const isStage1 = currentStage === 1;
            const currentQuestions = isStage1 ? stage1Questions : stage2Questions;
            const currentAnswers = isStage1 ? stage1Answers : stage2Answers;
            const currentAnswered = Object.keys(currentAnswers).length;
            const currentTotal = currentQuestions.length;
            const progress = (currentAnswered / currentTotal) * 100;
            
            // ì§„í–‰ë¥  ë°” ì—…ë°ì´íŠ¸
            const progressFill = document.getElementById('progress-fill');
            const progressText = document.getElementById('progress-text');
            
            if (progressFill && progressText) {
                progressFill.style.width = `${progress}%`;
                progressText.textContent = `ì§„í–‰ë„: ${currentAnswered}/${currentTotal} (${Math.round(progress)}%)`;
                
                // í˜„ì¬ ë‹¨ê³„ ì™„ë£Œì‹œ 100%ë¡œ ì„¤ì •
                if (currentAnswered === currentTotal) {
                    progressFill.style.width = '100%';
                    progressText.textContent = `ì§„í–‰ë„: ${currentAnswered}/${currentTotal} (100%)`;
                }
            }
        }

        function calculateStage1Result() {
            const total = Object.values(stage1Answers).reduce((sum, value) => sum + value, 0);
            const band = stage1Bands.find(b => total >= b.min && total <= b.max);
            return { total, band };
        }

        function calculateStage2Result() {
            const scores = { overload: 0, neglect: 0, frustration: 0 };
            
            Object.values(stage2Answers).forEach(choiceKey => {
                const weights = stage2Weights[choiceKey];
                if (weights) {
                    Object.entries(weights).forEach(([type, weight]) => {
                        scores[type] += weight;
                    });
                }
            });

            const total = Object.values(scores).reduce((sum, value) => sum + value, 0);
            const distribution = Object.entries(scores).map(([key, value]) => ({
                key,
                label: typeLabels[key],
                value,
                percentage: total === 0 ? 0 : Math.round((value / total) * 100)
            })).sort((a, b) => b.value - a.value);

            return { scores, distribution };
        }

        function showStage1Results() {
            const stage1Result = calculateStage1Result();
            
            // ìŠ¤í…Œì´ì§€ ì¸ë””ì¼€ì´í„° ì—…ë°ì´íŠ¸
            updateStageIndicator();
            
            const resultsHtml = `
                <div class="result-card">
                    <div class="result-title">ğŸ¯ 1ì°¨ ì§„ë‹¨ ê²°ê³¼</div>
                    <div class="result-content">
                        <div style="text-align: center; margin: 20px 0;">
                            <div style="font-size: 3rem; font-weight: bold; color: ${stage1Result.band ? stage1Result.band.color : '#198754'}; margin-bottom: 10px;">
                                ${stage1Result.total}/60
                            </div>
                            <div style="font-size: 1.5rem; font-weight: bold; color: ${stage1Result.band ? stage1Result.band.color : '#198754'};">
                                ${stage1Result.band ? stage1Result.band.label : 'ë“±ê¸‰ ê³„ì‚° ì‹¤íŒ¨'}
                            </div>
                        </div>
                        <div style="background: #f8f9fa; padding: 20px; border-radius: 10px; margin-top: 20px;">
                            <h4 style="color: #198754; margin-bottom: 10px;">ğŸ“Š ì ìˆ˜ í•´ì„</h4>
                            <p style="margin-bottom: 10px;"><strong>ë‚®ì€ ìœ„í—˜ (0-20ì ):</strong> ë²ˆì•„ì›ƒ ìœ„í—˜ì´ ë‚®ìŠµë‹ˆë‹¤. í˜„ì¬ ìƒíƒœë¥¼ ìœ ì§€í•˜ì„¸ìš”.</p>
                            <p style="margin-bottom: 10px;"><strong>ë³´í†µ ìœ„í—˜ (21-40ì ):</strong> ì£¼ì˜ê°€ í•„ìš”í•©ë‹ˆë‹¤. ìŠ¤íŠ¸ë ˆìŠ¤ ê´€ë¦¬ì— ì‹ ê²½ ì“°ì„¸ìš”.</p>
                            <p><strong>ë†’ì€ ìœ„í—˜ (41-60ì ):</strong> ì „ë¬¸ê°€ ìƒë‹´ì„ ê¶Œì¥í•©ë‹ˆë‹¤. ì¦‰ì‹œ ë„ì›€ì„ ë°›ìœ¼ì„¸ìš”.</p>
                        </div>
                    </div>
                </div>

                <div class="stage-separator">
                    <h2>ğŸ” 2ì°¨ ì§„ë‹¨ìœ¼ë¡œ ë„˜ì–´ê°€ê¸°</h2>
                    <p>1ì°¨ ì§„ë‹¨ì´ ì™„ë£Œë˜ì—ˆìŠµë‹ˆë‹¤. ì´ì œ ë²ˆì•„ì›ƒ ìœ í˜•ì„ ë¶„ì„í•˜ëŠ” 2ì°¨ ì§„ë‹¨ì„ ì§„í–‰í•´ë³´ì„¸ìš”.</p>
                    <p>2ì°¨ ì§„ë‹¨ì—ì„œëŠ” ê³¼ë¶€í•˜í˜•, ë°©ì¹˜í˜•, ì¢Œì ˆí˜• ì¤‘ ì–´ë–¤ ìœ í˜•ì— í•´ë‹¹í•˜ëŠ”ì§€ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p>
                    <button class="continue-btn" onclick="startStage2()">2ì°¨ ì§„ë‹¨ ì‹œì‘í•˜ê¸°</button>
                </div>

                <div class="button-container">
                    <button class="btn btn-secondary" onclick="resetTest()">ì²˜ìŒë¶€í„° ë‹¤ì‹œ</button>
                    <button class="btn btn-primary" onclick="window.location.reload()">ìƒˆë¡œ ì‹œì‘</button>
                </div>
            `;

            // ê²°ê³¼ í‘œì‹œ
            const resultsContent = document.getElementById('results-content');
            const resultsContainer = document.getElementById('results-container');
            const questionContainer = document.getElementById('question-container');
            const buttonContainer = document.getElementById('button-container');
            const progressContainer = document.getElementById('progress-container');
            
            if (resultsContent) resultsContent.innerHTML = resultsHtml;
            if (resultsContainer) resultsContainer.classList.add('show');
            if (questionContainer) questionContainer.style.display = 'none';
            if (buttonContainer) buttonContainer.style.display = 'none';
            if (progressContainer) progressContainer.style.display = 'none';
        }

        function startStage2() {
            // 2ì°¨ ì§„ë‹¨ ì‹œì‘
            currentStage = 2;
            currentQuestionIndex = 0;
            
            // UI ì—…ë°ì´íŠ¸
            updateStageIndicator();
            
            // ê²°ê³¼ ì»¨í…Œì´ë„ˆ ìˆ¨ê¸°ê¸°
            const resultsContainer = document.getElementById('results-container');
            const questionContainer = document.getElementById('question-container');
            const buttonContainer = document.getElementById('button-container');
            const progressContainer = document.getElementById('progress-container');
            
            if (resultsContainer) resultsContainer.classList.remove('show');
            if (questionContainer) questionContainer.style.display = 'block';
            if (buttonContainer) buttonContainer.style.display = 'flex';
            if (progressContainer) progressContainer.style.display = 'block';
            
            // ì²« ë²ˆì§¸ ì§ˆë¬¸ í‘œì‹œ
            showQuestion();
            updateProgress();
        }

        function showFinalResults() {
            const stage1Result = calculateStage1Result();
            const stage2Result = calculateStage2Result();
            
            // ìŠ¤í…Œì´ì§€ ì¸ë””ì¼€ì´í„° ì—…ë°ì´íŠ¸
            updateStageIndicator();
            const stage3Indicator = document.getElementById(`stage3-indicator`);
            if (stage3Indicator) {
                stage3Indicator.classList.add('active');
            }
            
            const resultsHtml = `
                <div class="result-card">
                    <div class="result-title">ğŸ¯ 1ì°¨ ì§„ë‹¨ ê²°ê³¼</div>
                    <div class="result-content">
                        <strong>ì´ì : ${stage1Result.total} / 60</strong><br>
                        ${stage1Result.band ? `<span style="color: ${stage1Result.band.color}; font-weight: bold;">${stage1Result.band.label}</span>` : 'ë“±ê¸‰ ê³„ì‚° ì‹¤íŒ¨'}
                    </div>
                </div>

                <div class="result-card">
                    <div class="result-title">ğŸ” 2ì°¨ ìœ í˜• ë¶„í¬</div>
                    <div class="type-distribution">
                        ${stage2Result.distribution.map((item, index) => `
                            <div class="type-item ${index === 0 ? 'primary' : ''}">
                                <div class="type-name">${item.label}</div>
                                <div class="type-percentage">${item.percentage}%</div>
                            </div>
                        `).join('')}
                    </div>
                    <div class="result-content">
                        <strong>ëŒ€í‘œ íŒì •: ${stage2Result.distribution[0].label}</strong><br>
                        ${stage2Result.distribution[0].percentage >= 40 ? '' : 
                          `(2ìœ„ì™€ì˜ ì°¨ì´ê°€ 10% ì´í•˜ì¸ ê²½ìš° ${stage2Result.distribution[1].label}ì™€ ì¡°í•©í˜•ìœ¼ë¡œ íŒì •)`
                        }
                    </div>
                </div>

                <div class="result-card">
                    <div class="result-title">ğŸ“š ìœ í˜• í•´ì„¤</div>
                    <div class="result-content">
                        ${Object.entries(typeDescriptions).map(([key, desc]) => `
                            <div style="margin-bottom: 15px;">
                                <strong>${typeLabels[key]}:</strong><br>
                                ${desc}
                            </div>
                        `).join('')}
                    </div>
                </div>

                <div class="consultation-card">
                    <h3>ğŸ’¡ 1:1 ë²ˆì•„ì›ƒ ë¬´ë£Œ ì „í™”ìƒë‹´ ì‹ ì²­</h3>
                    <p>ë§¤ì¼ í•˜ë£¨ê°€ ë‹µë‹µí•˜ê³  ë¶ˆì•ˆí•˜ê³  ê´´ë¡œìš´ë° ì–´ë–»ê²Œ í•´ê²°í•´ì•¼ ë ì§€ ëª¨ë¥´ì‹œì§€ ì•Šìœ¼ì‹œë‚˜ìš”?</p>
                    <p>ë²ˆì•„ì›ƒ í•˜ë£¨ ì½”ì¹­ì€ 'í•˜ë£¨'ë¼ëŠ” ë‹¨ìœ„ì— ì˜¨ì „íˆ ëª°ì…í•¨ìœ¼ë¡œì¨, ë¶ˆì•ˆ ì—†ì´ ì¼ê³¼ ì‚¶ì„ ë¶„ë¦¬í•˜ê³  ë²ˆì•„ì›ƒì„ ê·¹ë³µí•˜ê³  ë‚˜ì˜ ì¼ìƒì„ íšŒë³µí•  ìˆ˜ ìˆë„ë¡ ë•ìŠµë‹ˆë‹¤.</p>
                    <a href="https://forms.gle/QFJMPVWV9nRq862j6" target="_blank" class="consultation-btn">
                        ë¬´ë£Œ ì „í™”ìƒë‹´ ì‹ ì²­í•˜ê¸°
                    </a>
                </div>

                <div class="button-container">
                    <button class="btn btn-secondary" onclick="resetTest()">ë‹¤ì‹œ ì‹œì‘</button>
                    <button class="btn btn-primary" onclick="window.location.reload()">ìƒˆë¡œ ì‹œì‘</button>
                </div>
            `;

            // ê²°ê³¼ í‘œì‹œ
            const resultsContent = document.getElementById('results-content');
            const resultsContainer = document.getElementById('results-container');
            const questionContainer = document.getElementById('question-container');
            const buttonContainer = document.getElementById('button-container');
            const progressContainer = document.getElementById('progress-container');
            
            if (resultsContent) resultsContent.innerHTML = resultsHtml;
            if (resultsContainer) resultsContainer.classList.add('show');
            if (questionContainer) questionContainer.style.display = 'none';
            if (buttonContainer) buttonContainer.style.display = 'none';
            if (progressContainer) progressContainer.style.display = 'none';
        }

        function resetTest() {
            // ì „ì—­ ë³€ìˆ˜ ì´ˆê¸°í™”
            currentStage = 1;
            currentQuestionIndex = 0;
            stage1Answers = {};
            stage2Answers = {};
            
            // ìŠ¤í…Œì´ì§€ ì¸ë””ì¼€ì´í„° ì´ˆê¸°í™”
            document.querySelectorAll('.stage-pill').forEach(pill => pill.classList.remove('active'));
            const stage1Indicator = document.getElementById('stage1-indicator');
            if (stage1Indicator) {
                stage1Indicator.classList.add('active');
            }
            
            // UI ìš”ì†Œë“¤ ì´ˆê¸°í™”
            const resultsContainer = document.getElementById('results-container');
            const questionContainer = document.getElementById('question-container');
            const buttonContainer = document.getElementById('button-container');
            const progressContainer = document.getElementById('progress-container');
            
            if (resultsContainer) resultsContainer.classList.remove('show');
            if (questionContainer) questionContainer.style.display = 'block';
            if (buttonContainer) buttonContainer.style.display = 'flex';
            if (progressContainer) progressContainer.style.display = 'block';
            
            // ê²°ê³¼ ì»¨í…Œì´ë„ˆ ë‚´ìš© ì´ˆê¸°í™”
            const resultsContent = document.getElementById('results-content');
            if (resultsContent) resultsContent.innerHTML = '';
            
            // ì§„í–‰ë¥  ì´ˆê¸°í™”
            const progressFill = document.getElementById('progress-fill');
            const progressText = document.getElementById('progress-text');
            if (progressFill) progressFill.style.width = '0%';
            if (progressText) progressText.textContent = 'ì§„í–‰ë„: 0/22 (0%)';
            
            // ì²« ë²ˆì§¸ ì§ˆë¬¸ í‘œì‹œ
            showQuestion();
            updateProgress();
            
            // ë‹¤ìŒ ë²„íŠ¼ ìƒíƒœ ì—…ë°ì´íŠ¸ (showQuestion í›„ì— ì‹¤í–‰)
            setTimeout(() => {
                updateNextButton();
            }, 100);
        }
    </script>
</body>
</html>
